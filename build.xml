<?xml version="1.0" encoding="UTF-8" ?>

<project name="Carrot2 Website build/ publish script." default="help" basedir="." >

  <!-- The root of the generated documentation -->
  <property name="build.dir"        value="tmp/build" />
  <property name="distribution.dir" value="tmp/dist" />

  <!-- ##################################### -->
  <!-- ### {{{ CLEAN project             ### -->
  <!-- ##################################### -->

  <target name="clean" description="Removes all temporary files.">
        <delete failonerror="false" includeemptydirs="true" quiet="true">
            <fileset dir="tmp" />
        </delete>
  </target>
  <!-- }}} -->


  <!-- ######################################################### -->
  <!-- ### {{{ copies all necessary files to build directory ### -->
  <!-- ######################################################### -->

  <target name="prepare">
    <mkdir dir="${build.dir}" />
    <mkdir dir="${distribution.dir}" />
    
    <mkdir dir="${build.dir}/site" />
    <copy filtering="false" includeemptydirs="true" todir="${build.dir}/site">
        <fileset dir="site" />
    </copy>
    <copy filtering="false" includeemptydirs="true" todir="${build.dir}/xslt">
        <fileset dir="xslt" />
    </copy>
  </target>
  
  
  <!-- ######################################################### -->
  <!-- ### {{{ Assembles a PHP structure of the web page     ### -->
  <!-- ######################################################### -->
  <target name="build.php" depends="prepare"
          description="Assembles a PHP structure of the web page.">
    <copy todir="${distribution.dir}" includeemptydirs="true">
        <fileset dir="${build.dir}" includes="**/*" />
    </copy>
    <copy todir="${distribution.dir}" includeemptydirs="true">
        <fileset dir="renderer-sin/php">
            <include name="**/*" />
            <include name=".htaccess" />
        </fileset>
    </copy>
    <echo>
*** IMPORTANT ***
The Website uses PHP and SIN - an XSLT processing framework to run.
XSLTPROC must be available on the server (in command line)
and php's safe_mode must be turned off.
    </echo>
  </target>
  <!-- }}} -->

  
  <!-- ######################################################### -->
  <!-- ### {{{ Assembles a Java WAR structure of the web page### -->
  <!-- ###                           (for previewing mostly) ### -->
  <!-- ######################################################### -->
  <target name="build.war" depends="prepare"
          description="Assembles a WAR structure of the web page.">
          
    <delete failonerror="false" quiet="true" file="${distribution.dir}/carrot2-website.war" />
    <copy file="renderer-sin/java/sin-java-base.zip" tofile="${distribution.dir}/carrot2-website.war" />
    <zip basedir="${build.dir}" compress="true" update="true" zipfile="${distribution.dir}/carrot2-website.war" />
  </target>
  <!-- }}} -->

  
  <!-- ##################################### -->
  <!-- ### {{{ HELP ON THIS FILE         ### -->
  <!-- ##################################### -->
  <target name="help" description="Displays help on available targets.">
    <echo>

    Project name: ${ant.project.name}
    (c) Poznan University of Technology.

    Current JDK: ${ant.java.version}
    Basedir    : ${basedir}
    -----------------------------------------------------

    Type ant -projecthelp for more information about available tasks.
    
    </echo>
  </target>
  <!-- }}} -->

</project>

